<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Jonathan Walter, Thomas Anderson, Lei Zhao, Daniel Reuman" />

<meta name="date" content="2018-05-02" />

<title>Matrix model selection package</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Matrix model selection package</h1>
<h4 class="author"><em>Jonathan Walter, Thomas Anderson, Lei Zhao, Daniel Reuman</em></h4>
<h4 class="date"><em>2018-05-02</em></h4>



<!--Thoughts on what should maybe be included:
Brief qualitative intro to matrix model selection, with references
Reference to Jon's paper, and Tom's Oikos and L&O (hopefully) papers
I would ike to have an example using real data, Jon's gypsy moth or Tom's Oikos would be good, but need something where the 
  data (or a suitable subset) can be included, and it also needs to run reasonably fast
Basically we describe the method (copy from the section in supp mat in Ecol Lett, basically)
We also will have to intro the data
Mention the likelihood methods, cite the relevant papers, say the contexts where those wont work
Show the use of all the functions that the user needs on the data
Don't forget the new function matregtest
-->
<p>The mms package provides tools to do model selection among matrix models via a leave-n-out cross validation and resampling approach.</p>
<div id="brief-introduction-to-matrix-regression" class="section level1">
<h1>Brief introduction to matrix regression</h1>
<p>If <span class="math inline">\(i=1,\ldots,P\)</span> are sampling locations or other identifiers and matrices $M_</p>
</div>
<div id="example-data" class="section level1">
<h1>Example data</h1>
</div>
<div id="model-selection-on-matrix-models-and-the-package-functions" class="section level1">
<h1>Model selection on matrix models and the package functions</h1>
<!--This includes:
How to call the functions, how to interpret results - done on the example data, simultaneous description of how to use the functions and how   to interpret the stats
Brief statement on why the usual AIC methods wont work here
Brief statement on the likelihood methods that exist (REFS) and why they wont work here
-->
</div>
<div id="details-of-the-method" class="section level1">
<h1>Details of the method</h1>
<!--Much like the suppmat section of Jon's Ecol Lett paper that is about these methods -->
</div>
<div id="simulation-study-of-effectiveness" class="section level1">
<h1>Simulation study of effectiveness</h1>
<!-- Not sure what this will be or even if it will remain. Could be a paired down version of the model-based proof of effeciveness
of the method that is in Jon's Ecol Lett paper, or could be that whole thing reproduced (but watch run times) or could just be a 
summary of the results that appear there and a citation-->
<p>The effectiveness of matrix model selection using leave-n-out cross-validation (lnocv) can be demonstrated by applying mms to data generated by a theoretical model designed to simulate geographies of synchrony arising from one or more mechanisms (Walter et al. 2017). Here, we describe the model and its implementation for a test-case showing that lnocv can discriminate among a true predictor and multiple spurious predictors representing mechanisms not operating in the model. A more comprehensive suite of tests of effectiveness are described in Walter et al. (2017).</p>
<!--Paraphrase model description from EcoLetts paper-->
<p>The model is an extension of a vector autoregressive moving-average (VARMA) model that generates time series of abundance that may be correlated across multiple locations. The model simulates populations at locations <span class="math inline">\(i\)</span> = 1, …, <span class="math inline">\(P\)</span>, with populations linked by dispersal and subject to spatially correlated environmental fluctuations (Moran Effects). Fluctuations about the within-patch carrying capacity are denoted <span class="math inline">\(w_{i}(t)\)</span> for time <span class="math inline">\(t\)</span>. The <span class="math inline">\(\epsilon_{i}^{(j)}(t)\)</span> are environmental conditions for potential Moran drivers. Dispersal is implemented via a <span class="math inline">\(P\)</span> by <span class="math inline">\(P\)</span> connectivity matrix, <span class="math inline">\(D\)</span>. Population density dependence is controlled by the autoregressive coefficients <span class="math inline">\(m_{il}\)</span>, while the influence of environmental variables is given by the moving average coefficients <span class="math inline">\(q_{il}^{(j)}\)</span>. The model is:</p>
<!--Slightly modified tex for eqn 5 from EcoLetts sup mat-->
<span class="math display">\[\begin{equation}
\left(
\begin{array}{c}
w_1(t) \\
\vdots \\
w_P(t)
\end{array}
\right) \approx D
\left[
\left(
\begin{array}{c}
\sum_{l = 1}^{a}m_{ 1l}w_{ 1}(t  - l)+\sum_{j=1}^{b}\sum_{l=0}^{c}q_{1l}^{(j)}\epsilon_{1}^{(j)}(t-l) \\
\vdots \\
\sum_{l = 1}^{a}m_{ Pl}w_{ P}(t  - l)+\sum_{j=1}^{b}\sum_{l=0}^{c}q_{Pl}^{(j)}\epsilon_{P}^{(j)}(t-l) \\
\end{array}
\right)
\right],
\end{equation}\]</span>
<p>Here we consider a scenario in which spatial structure in population dynamics (i.e., geography of synchrony) arises from spatial structure in an environmental driver. The data produced are identical to those used to present “mechanism A”&quot; in Walter et al. (2017). We simulated population dynamics in <span class="math inline">\(P=16\)</span> locations divided between two disjoint eight-location sets, <span class="math inline">\(S_1\)</span> and <span class="math inline">\(S_2\)</span>. <span class="math inline">\(S_1\)</span> was {1,…,8} and <span class="math inline">\(S_2\)</span> was {9,…,16}. All locations had identical 2nd-order density dependence with <span class="math inline">\(m_{i1} \approx 0.375\)</span> and <span class="math inline">\(m_{i2} \approx -0.368\)</span>. These parameters produce periodic oscillations with a dominant period length of <span class="math inline">\(\approx\)</span> 5 time steps. We simulated three environmetnal drivers: an “operating” driver that strongly influences population dynamics (i.e., <span class="math inline">\(q_{i1}^{(1)}=1\)</span>) and is spatially structured; a “latent” driver that is also spatially structured but does not influence population dynamics (i.e., <span class="math inline">\(q_{i1}^{(2)}=0\)</span>); and a third driver representing local variability that is spatially unstructured (random) and has a small influence on population dynamics (i.e., <span class="math inline">\(q_{i1}^{(2)}=0.1\)</span>). Spatial structure in environmental drivers was given by the covariance matrices <span class="math inline">\(\Omega_{j}\)</span>, which were block matrices having off-diagona entries <span class="math inline">\(0.6\)</span> within <span class="math inline">\(S_1\)</span> or <span class="math inline">\(S_2\)</span> and <span class="math inline">\(0.3\)</span> between groups. Organisms dispersed among populations such that 5% of each population dispersed evenly among all other populations. The model was run for 150 time steps with a 100 time step burn-in period.</p>
<!--Start example-->
<p>We use simulated data to define a response matrix and multiple predictors, including a true predictor representing the operating mechanism in the simulation described above, and two spurious predictors representing latent (non-operating) possible mechanisms. The data are available using:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(mms)
<span class="kw">data</span>(simdat)
<span class="kw">attach</span>(simdat)</code></pre></div>
<p>The object ‘simdat’ is a list containing four matrices. The first three are <span class="math inline">\(P\)</span> by <span class="math inline">\(t\)</span> matrices giving, respectively, abundances <span class="math inline">\(w_{i}(t)\)</span> and environmental fluctuations <span class="math inline">\(\epsilon_{i}^{(j)}(t)\)</span> for the operating (<span class="math inline">\(j=1\)</span>) and latent (<span class="math inline">\(j=2\)</span>) drivers. The fourth is the <span class="math inline">\(P\)</span> by <span class="math inline">\(P\)</span> dispersal matrix, <span class="math inline">\(D\)</span>. We then compute synchrony matrices using Pearson correlations:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">popsynch&lt;-<span class="kw">cor</span>(<span class="kw">t</span>(simdat<span class="op">$</span>pop), <span class="dt">method=</span><span class="st">&quot;pearson&quot;</span>)
driversynch&lt;-<span class="kw">cor</span>(<span class="kw">t</span>(simdat<span class="op">$</span>driver), <span class="dt">method=</span><span class="st">&quot;pearson&quot;</span>)
latentsynch&lt;-<span class="kw">cor</span>(<span class="kw">t</span>(simdat<span class="op">$</span>latent), <span class="dt">method=</span><span class="st">&quot;pearson&quot;</span>)</code></pre></div>
<!--I am for now assuming, pending an answer on the KY lake data, that there will be a more
instructional example above, so I am not being so verbose here-->
<p>The lnocv score for an individual model is obtained using <code>mmsscore</code>, e.g. for a model in which dispersal is the sole predictor of population synchrony:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">modmats&lt;-<span class="kw">list</span>(<span class="dt">popsynch=</span>popsynch, <span class="dt">driversynch=</span>driversynch, <span class="dt">latentsynch=</span>latentsynch, <span class="dt">dispersal=</span>simdat<span class="op">$</span>dispersal)
modscore&lt;-<span class="kw">mmsscore</span>(<span class="dt">mats=</span><span class="kw">list</span>(modmats<span class="op">$</span>popsynch, modmats<span class="op">$</span>dispersal), <span class="dt">pred=</span><span class="dv">2</span>, <span class="dt">n=</span><span class="dv">2</span>, <span class="dt">maxruns=</span><span class="dv">500</span>)
<span class="kw">print</span>(modscore)</code></pre></div>
<pre><code>## $lno.score
## [1] 0.03830168
## 
## $num.pos
## [1] 120
## 
## $num.att
## [1] 120
## 
## $num.rnk
## [1] 120
## 
## $num.usd
## [1] 120</code></pre>
<p>Note that in this case, and in those following, <code>maxruns</code> (and later, <code>nrand</code>) is set relatively low so that these examples can be run quickly. We recommend increasing these. A selection of models can be ranked using:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">modranks&lt;-<span class="kw">mmsrank</span>(<span class="dt">mats=</span>modmats, <span class="dt">model.names=</span><span class="ot">NA</span>, <span class="dt">n=</span><span class="dv">2</span>, <span class="dt">maxruns=</span><span class="dv">200</span>)
<span class="kw">print</span>(modranks)</code></pre></div>
<pre><code>##   model.names   lno.score num.pos num.att num.rnk num.usd
## 1           2 0.004491566     120     120     120     120
## 2           3 0.039231228     120     120     120     120
## 3           4 0.038301679     120     120     120     120
## 4         2:3 0.004633066     120     120     120     120
## 5     c(2, 4) 0.004550706     120     120     120     120
## 6         3:4 0.038963419     120     120     120     120
## 7         2:4 0.004695749     120     120     120     120</code></pre>
<p>Here, we use <code>model.nameds=NA</code> (the default) to test all combinations of predictors. The first matrix in <code>mats</code> is taken to be the response variable. Recall that in our example there is one operating environmental driver producing geography of synchrony. The model reflecting this receives the highest rank.</p>
<p>Model weights, corresponding to the frequency with which a model is the best performing in the candidate set are obtained using:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">modweights&lt;-<span class="kw">mmsmodwts</span>(<span class="dt">mats=</span>modmats, <span class="dt">n=</span><span class="dv">2</span>, <span class="dt">maxruns=</span><span class="dv">200</span>, <span class="dt">nrand=</span><span class="dv">50</span>)</code></pre></div>
<pre><code>## [1] &quot;mmsmodwts working on resampling 1 of 50&quot;
## [1] &quot;mmsmodwts working on resampling 2 of 50&quot;
## [1] &quot;mmsmodwts working on resampling 3 of 50&quot;
## [1] &quot;mmsmodwts working on resampling 4 of 50&quot;
## [1] &quot;mmsmodwts working on resampling 5 of 50&quot;
## [1] &quot;mmsmodwts working on resampling 6 of 50&quot;
## [1] &quot;mmsmodwts working on resampling 7 of 50&quot;
## [1] &quot;mmsmodwts working on resampling 8 of 50&quot;
## [1] &quot;mmsmodwts working on resampling 9 of 50&quot;
## [1] &quot;mmsmodwts working on resampling 10 of 50&quot;
## [1] &quot;mmsmodwts working on resampling 11 of 50&quot;
## [1] &quot;mmsmodwts working on resampling 12 of 50&quot;
## [1] &quot;mmsmodwts working on resampling 13 of 50&quot;
## [1] &quot;mmsmodwts working on resampling 14 of 50&quot;
## [1] &quot;mmsmodwts working on resampling 15 of 50&quot;
## [1] &quot;mmsmodwts working on resampling 16 of 50&quot;
## [1] &quot;mmsmodwts working on resampling 17 of 50&quot;
## [1] &quot;mmsmodwts working on resampling 18 of 50&quot;
## [1] &quot;mmsmodwts working on resampling 19 of 50&quot;
## [1] &quot;mmsmodwts working on resampling 20 of 50&quot;
## [1] &quot;mmsmodwts working on resampling 21 of 50&quot;
## [1] &quot;mmsmodwts working on resampling 22 of 50&quot;
## [1] &quot;mmsmodwts working on resampling 23 of 50&quot;
## [1] &quot;mmsmodwts working on resampling 24 of 50&quot;
## [1] &quot;mmsmodwts working on resampling 25 of 50&quot;
## [1] &quot;mmsmodwts working on resampling 26 of 50&quot;
## [1] &quot;mmsmodwts working on resampling 27 of 50&quot;
## [1] &quot;mmsmodwts working on resampling 28 of 50&quot;
## [1] &quot;mmsmodwts working on resampling 29 of 50&quot;
## [1] &quot;mmsmodwts working on resampling 30 of 50&quot;
## [1] &quot;mmsmodwts working on resampling 31 of 50&quot;
## [1] &quot;mmsmodwts working on resampling 32 of 50&quot;
## [1] &quot;mmsmodwts working on resampling 33 of 50&quot;
## [1] &quot;mmsmodwts working on resampling 34 of 50&quot;
## [1] &quot;mmsmodwts working on resampling 35 of 50&quot;
## [1] &quot;mmsmodwts working on resampling 36 of 50&quot;
## [1] &quot;mmsmodwts working on resampling 37 of 50&quot;
## [1] &quot;mmsmodwts working on resampling 38 of 50&quot;
## [1] &quot;mmsmodwts working on resampling 39 of 50&quot;
## [1] &quot;mmsmodwts working on resampling 40 of 50&quot;
## [1] &quot;mmsmodwts working on resampling 41 of 50&quot;
## [1] &quot;mmsmodwts working on resampling 42 of 50&quot;
## [1] &quot;mmsmodwts working on resampling 43 of 50&quot;
## [1] &quot;mmsmodwts working on resampling 44 of 50&quot;
## [1] &quot;mmsmodwts working on resampling 45 of 50&quot;
## [1] &quot;mmsmodwts working on resampling 46 of 50&quot;
## [1] &quot;mmsmodwts working on resampling 47 of 50&quot;
## [1] &quot;mmsmodwts working on resampling 48 of 50&quot;
## [1] &quot;mmsmodwts working on resampling 49 of 50&quot;
## [1] &quot;mmsmodwts working on resampling 50 of 50&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(modweights)</code></pre></div>
<pre><code>##   model.names freq.top num.pos num.att num.rnk num.usd
## 1           2       32    6000    6000    6000    5637
## 2           3        0    6000    6000    6000    5637
## 3           4        0    6000    6000    6000    5637
## 4         2:3        6    6000    6000    6000    5637
## 5     c(2, 4)        9    6000    6000    6000    5637
## 6         3:4        0    6000    6000    6000    5637
## 7         2:4        3    6000    6000    6000    5637</code></pre>
<p>Like for rankings, the correct model receives the highest weight. The model weights can be used further to generate variable importance weights:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">varimp&lt;-<span class="kw">mmsvarwts</span>(<span class="dt">pred=</span><span class="dv">2</span><span class="op">:</span><span class="dv">4</span>, <span class="dt">weights=</span>modweights, <span class="dt">prednames=</span><span class="kw">names</span>(modmats)[<span class="op">-</span><span class="dv">1</span>])
<span class="kw">print</span>(varimp)</code></pre></div>
<pre><code>##     prednames summed.weights
## 1 driversynch           1.00
## 2 latentsynch           0.18
## 3   dispersal           0.24</code></pre>
<p>The algorithm correctly identifies the operating environmental driver as the most important predictor.</p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
